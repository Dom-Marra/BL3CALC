
<div class="skill-tree-container">

    <svg xmlns="http://www.w3.org/2000/svg" height="100%" width="100%" viewBox="0 0 300 696" class="tree">
        <linearGradient *ngIf="color == 'blue'" id="blue-fill" x1="0" x2="0" y1="0" y2="1">
            <stop attr.offset="{{mainOff}}" stop-color="rgb(34, 92, 137)"/>
            <stop attr.offset="{{secondOff}}" stop-color="rgb(132, 164, 189)"/>
            <stop offset="0%" stop-color="rgb(9, 22, 35)"/>
        </linearGradient>
        <linearGradient *ngIf="color == 'green'" id="green-fill" x1="0" x2="0" y1="0" y2="1">
            <stop attr.offset="{{mainOff}}" stop-color="rgb(61, 97, 28)"/>
            <stop attr.offset="{{secondOff}}" stop-color="rgb(145, 166, 127)"/>
            <stop offset="0%" stop-color="rgb(24, 38, 10)"/>
        </linearGradient>
        <linearGradient *ngIf="color == 'red'" id="red-fill" x1="0" x2="0" y1="0" y2="1">
            <stop attr.offset="{{mainOff}}" stop-color="rgb(88, 47, 27)"/>
            <stop attr.offset="{{secondOff}}" stop-color="rgb(161, 138, 126)"/>
            <stop offset="0%" stop-color="rgb(36, 16, 5)"/>
        </linearGradient>
        

        
        <g transform="scale(.85) translate(27, 53)">
            <polygon  points="2,18 17,2 52,2 67,18
                            232,18 248,2 283,2 298,18 
                            298,674 280,694 
                            20,694 2,674" class="top-border"></polygon>
            <polygon points="2,18 17,2 52,2 67,18
                            232,18 248,2 283,2 298,18 
                            298,674 280,694 
                            20,694 2,674" class="middle-border"></polygon>
            <polygon points="2,18 17,2 52,2 67,18
                            232,18 248,2 283,2 298,18 
                            298,674 280,694 
                            20,694 2,674" class="main-back"></polygon>
            <polygon points="12,56 17,50 42,50 50,58 
                            250,58 258,50 283,50 288,56 
                            288,630 273,645 
                            27, 645, 12,630" class="main-front"></polygon>
            <image width="110%" height="18%" x="-5%" y="-10%"attr.href="{{header}}" ></image>
            <text class="tree-name doNotSelect" x="50%" y="96.5%" dominant-baseline="middle" text-anchor="middle">{{treeName}}</text>
        </g>
        
       
        
        <g [class.activated]="skill.getAllocatedPoints() > skill.MIN_POINTS" 
            class="skill doNotSelect" 
            *ngFor="let skill of skills" 
            (click)="addPoint(skill)" 
            (contextmenu)="removePoint(skill)"
            oncontextmenu="return false;" 
            transform="scale(0.85) translate(27 51)"
            (mouseenter)="showToolTip(skill, $event)"
            (mouseleave)="showToolTip(null, null)">

            <g *ngIf="skill.getPosition()[1] == -1" attr.transform="scale(0.85) translate(1, {{90 + skill.getPosition()[0] * 116}})">
                <polygon
                    class="special-skill-border"
                    points="-67,12 -55,0 3,0 2,81 -55,81 -67,69"
                />
                <polygon
                    class="special-skill-mid-border"
                    points="-67,12 -55,0 3,0 2,81 -55,81 -67,69"
                />
                <polygon
                    class="special-skill-main"
                    points="-67,12 -55,0 3,0 2,81 -55,81 -67,69"
                />
            </g>
            
            <g *ngIf="skill.getPosition()[1] == 3" attr.transform="scale(0.85) translate(49, {{90 + skill.getPosition()[0] * 116}})">
                <polygon
                    class="special-skill-border"
                    points="370,12 358,0 300,0 300,81 358,81 370,69"
                />
                <polygon
                    class="special-skill-mid-border"
                    points="370,12 358,0 300,0 300,81 358,81 370,69"
                />
                <polygon
                    class="special-skill-main"
                    points="370,12 358,0 300,0 300,81 358,81 370,69"
                />
            </g>

            
            <image [class.disabled]="allocatedPoints < skill.getPreReq()" height="10%" width="22.5%" 
                    attr.x="{{skill.getPosition()[1] < 0 ? 
                        -18 :
                        (skill.getPosition()[1] < 3 ? 
                        12 + (skill.getPosition()[1] * 27) :
                        94)}}%" 
                    attr.y="{{
                        11.12 + (skill.getPosition()[0] * 14.1)}}%" 
                    attr.href="{{skill.getSkillBoxPath()}}" />

            <image [class.disabled]="allocatedPoints < skill.getPreReq()" width="15.5%" height="6.5%"
                    attr.x="{{skill.getPosition()[1] < 0 ? 
                            -14.5:
                            (skill.getPosition()[1] < 3 ? 
                            16 + (skill.getPosition()[1] * 27) :
                            98)}}%"
                    attr.y="{{12.65 + (skill.getPosition()[0] * 14.1)}}%"
                    attr.href="{{skill.getPath()}}" />


                    
            <g [class.disabled]="allocatedPoints < skill.getPreReq()"
                *ngIf="(skill.getPosition()[1] >= 0 && skill.getPosition()[1] < 3  && skill.getPosition()[0] >= 0 )">
                <image height="4%" width="11.5%"
                        attr.x="{{25 + (skill.getPosition()[1] * 27)}}%" 
                        attr.y="{{18.75 + (skill.getPosition()[0] * 14.1)}}%" 
                        href="assets/images/skilltree/pointBox.webp" />
                <text class="points" 
                        attr.x="{{30.5 + (skill.getPosition()[1] * 27)}}%"
                        attr.y="{{21.5 + (skill.getPosition()[0] * 14.1)}}%"
                        text-anchor="middle"
                        >{{skill.allocatedPoints}}/{{skill.maxPoints}}</text>
            </g>
        </g>
    </svg>
</div>
